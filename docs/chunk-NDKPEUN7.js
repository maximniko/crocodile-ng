import{a as N,b as d,c as A,d as L,e as R,f as H,g as j,h as M,i as $,j as q,k as z}from"./chunk-ZB7YDQQK.js";import{a as K}from"./chunk-LBWSL2BW.js";import{$ as _,$a as P,C as h,D as g,K as w,M as o,N as m,S,Ta as G,U as E,Za as O,_a as V,ca as k,da as F,ea as C,fa as a,ga as l,ha as I,ja as B,la as c,ma as b,pa as x,qa as T,va as p,wa as u,ya as D}from"./chunk-WNI7Q5FO.js";var f=class s{constructor(e){this.el=e;if(!e.nativeElement.focus)throw new Error("Element does not accept focus.")}onEnter(e){this.el.nativeElement.blur()}onTouchEnd(e){this.el.nativeElement.blur()}ngOnInit(){let e=this.el.nativeElement;e.focus(),e.select()}static \u0275fac=function(r){return new(r||s)(m(w))};static \u0275dir=E({type:s,selectors:[["","focusOnShow",""]],hostBindings:function(r,t){r&1&&c("keyup.enter",function(n){return t.onEnter(n)})("touchend",function(n){return t.onTouchEnd(n)})}})};function Q(s,e){if(s&1){let r=B();a(0,"div",15)(1,"div",16)(2,"input",17),c("click",function(i){return h(r),g(i.stopPropagation())}),l(),a(3,"label",18),p(4),l()(),a(5,"span",19),c("click",function(){let i=h(r).$index,n=b();return g(n.delete(i))}),p(6,"X"),l()()}if(s&2){let r,t,i=e.$index,n=b();o(),x("formGroupName",i),o(),T("placeholder","",(r=n.l.messages.Player)!==null&&r!==void 0?r:"Player"," ",i+1,""),o(2),D("",(t=n.l.messages.Player)!==null&&t!==void 0?t:"Player"," ",i+1,"")}}var X=class s{constructor(e,r,t,i,n){this.formBuilder=e;this.playersService=r;this.l=t;this.router=i;this.twa=n;this.startPlayers=this.playersService.players,this.form=this.makeForm(this.startPlayers),this.goBack=this.goBack.bind(this)}form;startPlayers=[];ngOnInit(){this.twa.backButtonOnClick(this.goBack)}ngOnDestroy(){this.twa.offBackButton(this.goBack,!1)}goBack(){this.router.navigate([P.main()])}goToGame(){this.router.navigate([P.game()])}get players(){return this.form?.controls.players}addPlayer(e){this.players.push(this.playerGroup(e))}delete(e){this.players.removeAt(e)}reset(){this.playersService.savePlayers([]),this.form=this.makeForm([])}onSubmit(){if(this.form.invalid)return;let e=this.form?.get("players")?.value;this.playersService.savePlayers(e),this.goToGame()}makeForm(e){return this.formBuilder.group({players:this.formBuilder.array(e?.length?e.map(r=>this.playerGroup(r)):[this.playerGroup()],[this.minLengthArray(2)])})}playerGroup(e){return this.formBuilder.group({name:this.formBuilder.control(e?.name??"",[d.required,d.minLength(2),d.maxLength(16),this.uniqueTitleValidator("name")])})}uniqueTitleValidator(e){return r=>{if(!this.players)return null;let t=[];for(let i=0;i<=this.players.controls.length;i++){let n=this.players.controls[i]?.get(e)?.value;n&&t.push(n.trim().toLowerCase())}return this.hasDuplicates(t)?{duplicate:!0}:null}}minLengthArray(e){return r=>r.value.length>=e?null:{minLengthArray:!0}}hasDuplicates(e){return e.length!==new Set(e).size}static \u0275fac=function(r){return new(r||s)(m(q),m(K),m(V),m(G),m(O))};static \u0275cmp=S({type:s,selectors:[["ng-component"]],decls:25,vars:6,consts:[[1,"bg-purple","h-100","position-relative"],[1,"position-absolute","h-100","w-100","overflow-hidden"],["src","assets/images/palm.svg","alt","palm",1,"palm"],["src","assets/images/umbrella.svg","alt","umbrella",1,"umbrella"],["src","assets/images/sand.svg","alt","sand",1,"sand"],[1,"overflow-y-scroll","position-relative","h-100","z-3"],[1,"container","my-3","pt-5"],[1,"row","row-cols-2","g-2"],[1,"col-12"],[1,"h2","text-center","text-white"],[1,"col"],[1,"btn","btn-lg","btn-white","btn-outline-secondary","w-100",3,"click"],["type","submit",1,"btn","btn-lg","btn-success","w-100",3,"click","disabled"],[3,"formGroup"],["formArrayName","players",1,"d-flex","flex-column-reverse"],[1,"input-group","mb-3"],[1,"form-floating",3,"formGroupName"],["focusOnShow","","autocapitalize","none","type","text","id","floatingName","formControlName","name",1,"form-control",3,"click","placeholder"],["for","floatingName"],[1,"input-group-text",3,"click"]],template:function(r,t){if(r&1&&(a(0,"main",0)(1,"div",1),I(2,"img",2)(3,"img",3)(4,"img",4),l(),a(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"h2",9),p(10),l()(),a(11,"div",10)(12,"button",11),c("click",function(){return t.reset()}),p(13),l()(),a(14,"div",10)(15,"button",12),c("click",function(){return t.onSubmit()}),p(16),l()(),a(17,"div",8)(18,"button",11),c("click",function(){return t.addPlayer()}),p(19),l()(),a(20,"div",8)(21,"form",13)(22,"div",14),F(23,Q,7,6,"div",15,k),l()()()()()()()),r&2){let i,n,v,y;o(10),u((i=t.l.messages.Players)!==null&&i!==void 0?i:"Players"),o(3),u((n=t.l.messages.Reset)!==null&&n!==void 0?n:"Reset"),o(2),_("disabled",t.form.invalid),o(),u((v=t.l.messages.Play)!==null&&v!==void 0?v:"Play"),o(3),u((y=t.l.messages.Add)!==null&&y!==void 0?y:"Add"),o(2),_("formGroup",t.form),o(2),C(t.players.controls)}},dependencies:[z,R,N,A,L,H,$,j,M,f],encapsulation:2})};export{X as PlayersComponent};
