import{a as N,b as d,c as G,d as L,e as R,f as H,g as j,h as M,i as $,j as q,k as z}from"./chunk-ONSSS4PB.js";import{a as A}from"./chunk-W5HCQ4JQ.js";import{$a as V,A as h,B as g,I as P,K as o,L as c,Q as S,S as k,Ua as D,Z as _,_a as O,aa as E,ab as K,ba as w,ca as F,da as a,ea as l,ha as C,ja as m,ka as b,na as I,oa as B,ta as p,ua as u,va as x,wa as T}from"./chunk-O5YTUWJN.js";var f=class s{constructor(e){this.el=e;if(!e.nativeElement.focus)throw new Error("Element does not accept focus.")}onEnter(e){this.el.nativeElement.blur()}onTouchEnd(e){this.el.nativeElement.blur()}ngOnInit(){let e=this.el.nativeElement;e.focus(),e.select()}static \u0275fac=function(i){return new(i||s)(c(P))};static \u0275dir=k({type:s,selectors:[["","focusOnShow",""]],hostBindings:function(i,r){i&1&&m("keyup.enter",function(n){return r.onEnter(n)})("touchend",function(n){return r.onTouchEnd(n)})}})};function Q(s,e){if(s&1){let i=C();a(0,"div",9)(1,"div",10)(2,"input",11),m("click",function(t){return h(i),g(t.stopPropagation())}),l(),a(3,"label",12),p(4),l()(),a(5,"span",13),m("click",function(){let t=h(i).$index,n=b();return g(n.delete(t))}),p(6,"X"),l()()}if(s&2){let i,r,t=e.$index,n=b();o(),I("formGroupName",t),o(),B("placeholder","",(i=n.l.messages.Player)!==null&&i!==void 0?i:"Player"," ",t+1,""),o(2),T("",(r=n.l.messages.Player)!==null&&r!==void 0?r:"Player"," ",t+1,"")}}var X=class s{constructor(e,i,r,t,n){this.formBuilder=e;this.playersService=i;this.l=r;this.router=t;this.twa=n;this.startPlayers=this.playersService.players,this.form=this.makeForm(this.startPlayers),this.goBack=this.goBack.bind(this)}form;startPlayers=[];ngOnInit(){this.twa.backButtonOnClick(this.goBack)}ngOnDestroy(){this.twa.offBackButton(this.goBack,!1)}goBack(){this.router.navigate([K.main()])}get players(){return this.form?.controls.players}addPlayer(e){this.players.push(this.playerGroup(e))}delete(e){this.players.removeAt(e)}reset(){this.playersService.savePlayers([]),this.form=this.makeForm([])}onSubmit(){if(this.form.invalid)return;let e=this.form?.get("players")?.value;this.playersService.savePlayers(e),this.goBack()}makeForm(e){return this.formBuilder.group({players:this.formBuilder.array(e?.length?e.map(i=>this.playerGroup(i)):[this.playerGroup()],[this.minLengthArray(2)])})}playerGroup(e){return this.formBuilder.group({name:this.formBuilder.control(e?.name??"",[d.required,d.minLength(2),d.maxLength(16),this.uniqueTitleValidator("name")])})}uniqueTitleValidator(e){return i=>{if(!this.players)return null;let r=[];for(let t=0;t<=this.players.controls.length;t++){let n=this.players.controls[t]?.get(e)?.value;n&&r.push(n.trim().toLowerCase())}if(this.hasDuplicates(r))return{duplicate:!0};for(let t=0;t<=this.players.controls.length;t++)this.players.controls[t]?.get(e)?.setErrors(null);return null}}minLengthArray(e){return i=>i.value.length>=e?null:{minLengthArray:!0}}hasDuplicates(e){return e.length!==new Set(e).size}static \u0275fac=function(i){return new(i||s)(c(q),c(A),c(V),c(D),c(O))};static \u0275cmp=S({type:s,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","gap-2","pb-5"],decls:16,vars:6,consts:[[1,"text-center","h3","my-3"],[1,"row","row-cols-2","g-2"],[1,"col"],[1,"btn","btn-lg","btn-outline-secondary","w-100",3,"click"],["type","submit",1,"btn","btn-lg","btn-outline-primary","w-100",3,"click","disabled"],[1,"col-12"],[1,"btn","btn-lg","btn-primary","w-100",3,"click"],[3,"formGroup"],["formArrayName","players",1,"d-flex","flex-column-reverse"],[1,"input-group","mb-3"],[1,"form-floating",3,"formGroupName"],["focusOnShow","","autocapitalize","none","type","text","id","floatingName","formControlName","name",1,"form-control",3,"click","placeholder"],["for","floatingName"],[1,"input-group-text",3,"click"]],template:function(i,r){if(i&1&&(a(0,"div",0),p(1),l(),a(2,"div",1)(3,"div",2)(4,"button",3),m("click",function(){return r.reset()}),p(5),l()(),a(6,"div",2)(7,"button",4),m("click",function(){return r.onSubmit()}),p(8),l()(),a(9,"div",5)(10,"button",6),m("click",function(){return r.addPlayer()}),p(11),l()()(),a(12,"form",7)(13,"div",8),w(14,Q,7,6,"div",9,E),l()()),i&2){let t,n,y,v;o(),u((t=r.l.messages.Players)!==null&&t!==void 0?t:"Players"),o(4),u((n=r.l.messages.Reset)!==null&&n!==void 0?n:"Reset"),o(2),_("disabled",r.form.invalid),o(),x("",(y=r.l.messages.Save)!==null&&y!==void 0?y:"Save"," "),o(3),u((v=r.l.messages.Add)!==null&&v!==void 0?v:"Add"),o(),_("formGroup",r.form),o(2),F(r.players.controls)}},dependencies:[z,R,N,G,L,H,$,j,M,f],encapsulation:2})};export{X as PlayersComponent};
