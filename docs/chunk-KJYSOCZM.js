import{c as Ce}from"./chunk-TKG5KDX6.js";import"./chunk-PDCJNJX4.js";import{a as Te}from"./chunk-QLJSH3MI.js";import{d as De,h as Se}from"./chunk-5E4WEWTK.js";import{$a as O,A as re,Aa as U,B as ae,Ca as pe,Cb as Z,Fa as _e,H as le,Ja as A,La as y,Na as Q,P as D,Pa as T,Pb as we,T as R,Va as J,W as ce,Wa as C,Xa as F,Ya as S,Z as l,_a as M,ab as r,bb as c,ca as de,cb as Y,db as fe,ea as m,eb as w,fa as b,fb as N,g as k,gb as f,hb as h,ib as ge,j as x,ja as I,jb as me,l as ie,la as p,lb as B,ma as ue,mb as be,n as ne,nb as P,ob as E,pa as z,pb as d,qb as _,rb as G,sb as H,tb as ye,ub as ve,wa as he,wb as q,xb as K,y as se,z as oe,za as u}from"./chunk-FOGYDD3O.js";function V(t){t||(de(V),t=l(I));let n=new k(e=>t.onDestroy(e.next.bind(e)));return e=>e.pipe(D(n))}var ze=["container"],Ue=["ngbAccordionBody",""],Qe=["*"];var Oe={animation:!0,transitionTimerDelayMs:5},Ne=(()=>{class t{constructor(){this.animation=Oe.animation}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Je=(()=>{class t{constructor(){this._ngbConfig=l(Ne),this.closeOthers=!1,this.destroyOnHide=!0}get animation(){return this._animation??this._ngbConfig.animation}set animation(e){this._animation=e}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Ye(t){let{transitionDelay:n,transitionDuration:e}=window.getComputedStyle(t),i=parseFloat(n),s=parseFloat(e);return(i+s)*1e3}function qe(t){return typeof t=="string"}function Ke(t){return(t||document.body).getBoundingClientRect()}function Ze(t){return n=>new k(e=>{let i=a=>t.run(()=>e.next(a)),s=a=>t.run(()=>e.error(a)),o=()=>t.run(()=>e.complete());return n.subscribe({next:i,error:s,complete:o})})}var Xe=()=>{},{transitionTimerDelayMs:et}=Oe,$=new Map,tt=(t,n,e,i)=>{let s=i.context||{},o=$.get(n);if(o)switch(i.runningTransition){case"continue":return ie;case"stop":t.run(()=>o.transition$.complete()),s=Object.assign(o.context,s),$.delete(n)}let a=e(n,i.animation,s)||Xe;if(!i.animation||window.getComputedStyle(n).transitionProperty==="none")return t.run(()=>a()),ne(void 0).pipe(Ze(t));let g=new x,j=new x,W=g.pipe(le(!0));$.set(n,{transition$:g,complete:()=>{j.next(),j.complete()},context:s});let Fe=Ye(n);return t.runOutsideAngular(()=>{let Be=se(n,"transitionend").pipe(D(W),re(({target:He})=>He===n)),Ge=oe(Fe+et).pipe(D(W));ae(Ge,Be,j).pipe(D(W)).subscribe(()=>{$.delete(n),t.run(()=>{a(),g.next(),g.complete()})})}),g.asObservable()};function it(t,n){if(typeof navigator>"u")return"0px";let{classList:e}=t,i=e.contains("show");i||e.add("show"),t.style[n]="";let s=t.getBoundingClientRect()[n]+"px";return i||e.remove("show"),s}var nt=(t,n,e)=>{let{direction:i,maxSize:s,dimension:o}=e,{classList:a}=t;function g(){a.add("collapse"),i==="show"?a.add("show"):a.remove("show")}if(!n){g();return}return s||(s=it(t,o),e.maxSize=s,t.style[o]=i!=="show"?s:"0px",a.remove("collapse","collapsing","show"),Ke(t),a.add("collapsing")),t.style[o]=i==="show"?s:"0px",()=>{g(),a.remove("collapsing"),t.style[o]=""}},st=(()=>{class t{constructor(){this._ngbConfig=l(Ne),this.horizontal=!1}get animation(){return this._animation??this._ngbConfig.animation}set animation(e){this._animation=e}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Me=(()=>{class t{constructor(){this._config=l(st),this._element=l(z),this._zone=l(ue),this.animation=this._config.animation,this._afterInit=!1,this._isCollapsed=!1,this.ngbCollapseChange=new p,this.horizontal=this._config.horizontal,this.shown=new p,this.hidden=new p}set collapsed(e){this._isCollapsed!==e&&(this._isCollapsed=e,this._afterInit&&this._runTransitionWithEvents(e,this.animation))}ngOnInit(){this._runTransition(this._isCollapsed,!1),this._afterInit=!0}toggle(e=this._isCollapsed){this.collapsed=!e,this.ngbCollapseChange.next(this._isCollapsed)}_runTransition(e,i){return tt(this._zone,this._element.nativeElement,nt,{animation:i,runningTransition:"stop",context:{direction:e?"hide":"show",dimension:this.horizontal?"width":"height"}})}_runTransitionWithEvents(e,i){this._runTransition(e,i).subscribe(()=>{e?this.hidden.emit():this.shown.emit()})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","ngbCollapse",""]],hostVars:2,hostBindings:function(i,s){i&2&&F("collapse-horizontal",s.horizontal)},inputs:{animation:"animation",collapsed:[0,"ngbCollapse","collapsed"],horizontal:"horizontal"},outputs:{ngbCollapseChange:"ngbCollapseChange",shown:"shown",hidden:"hidden"},exportAs:["ngbCollapse"]})}}return t})(),ot=0,Pe=(()=>{class t{constructor(){this._item=l(v),this._viewRef=null,this.elementRef=l(z)}ngAfterContentChecked(){this._bodyTpl&&(this._item._shouldBeInDOM?this._createViewIfNotExists():this._destroyViewIfExists())}ngOnDestroy(){this._destroyViewIfExists()}_destroyViewIfExists(){this._viewRef?.destroy(),this._viewRef=null}_createViewIfNotExists(){this._viewRef||(this._viewRef=this._vcr.createEmbeddedView(this._bodyTpl),this._viewRef.detectChanges())}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=A({type:t,selectors:[["","ngbAccordionBody",""]],contentQueries:function(i,s,o){if(i&1&&B(o,pe,7),i&2){let a;P(a=E())&&(s._bodyTpl=a.first)}},viewQuery:function(i,s){if(i&1&&be(ze,7,_e),i&2){let o;P(o=E())&&(s._vcr=o.first)}},hostAttrs:[1,"accordion-body"],attrs:Ue,ngContentSelectors:Qe,decls:3,vars:0,consts:[["container",""]],template:function(i,s){i&1&&(ge(),fe(0,null,0),me(2))},encapsulation:2})}}return t})(),X=(()=>{class t{constructor(){this.item=l(v),this.ngbCollapse=l(Me)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","ngbAccordionCollapse",""]],hostAttrs:["role","region",1,"accordion-collapse"],hostVars:2,hostBindings:function(i,s){i&2&&(N("id",s.item.collapseId),J("aria-labelledby",s.item.toggleId))},exportAs:["ngbAccordionCollapse"],features:[Q([Me])]})}}return t})(),rt=(()=>{class t{constructor(){this.item=l(v),this.accordion=l(L)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","ngbAccordionToggle",""]],hostVars:5,hostBindings:function(i,s){i&1&&f("click",function(){return!s.item.disabled&&s.accordion.toggle(s.item.id)}),i&2&&(N("id",s.item.toggleId),J("aria-controls",s.item.collapseId)("aria-expanded",!s.item.collapsed),F("collapsed",s.item.collapsed))}})}}return t})(),Ee=(()=>{class t{constructor(){this.item=l(v)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["button","ngbAccordionButton",""]],hostAttrs:["type","button",1,"accordion-button"],hostVars:1,hostBindings:function(i,s){i&2&&N("disabled",s.item.disabled)},features:[Q([rt])]})}}return t})(),ke=(()=>{class t{constructor(){this.item=l(v)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","ngbAccordionHeader",""]],hostAttrs:["role","heading",1,"accordion-header"],hostVars:2,hostBindings:function(i,s){i&2&&F("collapsed",s.item.collapsed)}})}}return t})(),v=(()=>{class t{constructor(){this._accordion=l(L),this._cd=l(Z),this._destroyRef=l(I),this._collapsed=!0,this._id=`ngb-accordion-item-${ot++}`,this._collapseAnimationRunning=!1,this.disabled=!1,this.show=new p,this.shown=new p,this.hide=new p,this.hidden=new p}set id(e){qe(e)&&e!==""&&(this._id=e)}set destroyOnHide(e){this._destroyOnHide=e}get destroyOnHide(){return this._destroyOnHide===void 0?this._accordion.destroyOnHide:this._destroyOnHide}set collapsed(e){e?this.collapse():this.expand()}get collapsed(){return this._collapsed}get id(){return`${this._id}`}get toggleId(){return`${this.id}-toggle`}get collapseId(){return`${this.id}-collapse`}get _shouldBeInDOM(){return!this.collapsed||this._collapseAnimationRunning||!this.destroyOnHide}ngAfterContentInit(){let{ngbCollapse:e}=this._collapse;e.animation=!1,e.collapsed=this.collapsed,e.animation=this._accordion.animation,e.hidden.pipe(V(this._destroyRef)).subscribe(()=>{this._collapseAnimationRunning=!1,this.hidden.emit(),this._accordion.hidden.emit(this.id),this._cd.markForCheck()}),e.shown.pipe(V(this._destroyRef)).subscribe(()=>{this.shown.emit(),this._accordion.shown.emit(this.id),this._cd.markForCheck()})}toggle(){this.collapsed=!this.collapsed}expand(){if(this.collapsed){if(!this._accordion._ensureCanExpand(this))return;this._collapsed=!1,this._cd.markForCheck(),this._cd.detectChanges(),this.show.emit(),this._accordion.show.emit(this.id),this._collapse.ngbCollapse.animation=this._accordion.animation,this._collapse.ngbCollapse.collapsed=!1}}collapse(){this.collapsed||(this._collapsed=!0,this._collapseAnimationRunning=!0,this._cd.markForCheck(),this.hide.emit(),this._accordion.hide.emit(this.id),this._collapse.ngbCollapse.animation=this._accordion.animation,this._collapse.ngbCollapse.collapsed=!0)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","ngbAccordionItem",""]],contentQueries:function(i,s,o){if(i&1&&B(o,X,7),i&2){let a;P(a=E())&&(s._collapse=a.first)}},hostAttrs:[1,"accordion-item"],hostVars:1,hostBindings:function(i,s){i&2&&N("id",s.id)},inputs:{id:[0,"ngbAccordionItem","id"],destroyOnHide:"destroyOnHide",disabled:"disabled",collapsed:"collapsed"},outputs:{show:"show",shown:"shown",hide:"hide",hidden:"hidden"},exportAs:["ngbAccordionItem"]})}}return t})(),L=(()=>{class t{constructor(){this._config=l(Je),this._anItemWasAlreadyExpandedDuringInitialisation=!1,this.animation=this._config.animation,this.closeOthers=this._config.closeOthers,this.destroyOnHide=this._config.destroyOnHide,this.show=new p,this.shown=new p,this.hide=new p,this.hidden=new p}toggle(e){this._getItem(e)?.toggle()}expand(e){this._getItem(e)?.expand()}expandAll(){this._items&&(this.closeOthers?this._items.find(e=>!e.collapsed)||this._items.first.expand():this._items.forEach(e=>e.expand()))}collapse(e){this._getItem(e)?.collapse()}collapseAll(){this._items?.forEach(e=>e.collapse())}isExpanded(e){let i=this._getItem(e);return i?!i.collapsed:!1}_ensureCanExpand(e){return this.closeOthers?this._items?(this._items.find(i=>!i.collapsed&&e!==i)?.collapse(),!0):this._anItemWasAlreadyExpandedDuringInitialisation?!1:(this._anItemWasAlreadyExpandedDuringInitialisation=!0,!0):!0}_getItem(e){return this._items?.find(i=>i.id===e)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","ngbAccordion",""]],contentQueries:function(i,s,o){if(i&1&&B(o,v,4),i&2){let a;P(a=E())&&(s._items=a)}},hostAttrs:[1,"accordion"],inputs:{animation:"animation",closeOthers:"closeOthers",destroyOnHide:"destroyOnHide"},outputs:{show:"show",shown:"shown",hide:"hide",hidden:"hidden"},exportAs:["ngbAccordion"]})}}return t})();var Yi=(()=>{let t=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2,n=()=>/Android/.test(navigator.userAgent);return typeof navigator<"u"?!!navigator.userAgent&&(t()||n()):!1})();var qi=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");var Ki=new Date(1882,10,12),Zi=new Date(2174,10,25);var Xi=1e3*60*60*24;var ee=1080,at=24*ee,lt=12*ee+793,en=29*at+lt,tn=11*ee+204;var nn=new ce("live announcer delay",{providedIn:"root",factory:()=>100});var Ie=(t,n)=>n.title,ct=(t,n)=>n.gamePlayer.player.name,dt=(t,n)=>({"btn-success":t,"btn-secondary":n}),xe=(t,n,e,i)=>({"text-gold":t,"text-silver":n,"text-bronze":e,"text-secondary":i});function ut(t,n){t&1&&d(0," Loading ")}function ht(t,n){if(t&1){let e=w();r(0,"h2",0),d(1,"\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u0438\u0433\u0440\u043E\u043A"),c(),r(2,"h1",0),d(3),c(),r(4,"button",1),f("click",function(){m(e);let s=h();return b(s.playing())}),d(5,"\u0421\u0442\u0430\u0440\u0442!"),c()}if(t&2){let e=h();u(3),_(e.currentPlayer.name)}}function pt(t,n){if(t&1){let e=w();H(0),r(1,"button",5),f("click",function(){let s=m(e).$implicit,o=h(2);return b(o.toggleWord(s))}),r(2,"div",6),d(3),c(),r(4,"div",7),d(5),c(),r(6,"div",8),d(7),c()()}if(t&2){let e=n.$implicit,i=n.$index,s=h(2).isWordSelected(e);u(),C("ngClass",q(4,dt,s,!s)),u(2),_(i+1),u(2),_(e.title),u(2),_(e.level)}}function _t(t,n){t&1&&d(0," \u0420\u0430\u0443\u043D\u0434! ")}function ft(t,n){t&1&&d(0," \u0421\u043B\u0435\u0434 \u0438\u0433\u0440\u043E\u043A! ")}function gt(t,n){if(t&1){let e=w();r(0,"h1",0),d(1),c(),r(2,"div",2),M(3,pt,8,7,"button",3,Ie),c(),H(5),r(6,"button",4),f("click",function(){m(e);let s=ve(5),o=h();return b(s?o.endRound():o.nextPlayer())}),T(7,_t,1,0)(8,ft,1,0),c()}if(t&2){let e=h();u(),G("",e.currentPlayer.name,", \u043F\u043E\u043A\u0430\u0437\u044B\u0432\u0430\u0439"),u(2),O(e.currentGamePlayer.currentWords),u(2);let i=ye(e.isLastPlayerInRound());u(2),S(i?7:8)}}function mt(t,n){if(t&1){let e=w();d(0),r(1,"div",9)(2,"button",10),f("click",function(){m(e);let s=h();return b(s.toResult())}),d(3,"\u0421\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B!"),c(),r(4,"button",11),f("click",function(){m(e);let s=h();return b(s.nextPlayer())}),d(5,"\u0418\u0433\u0440\u0430\u0442\u044C \u0435\u0449\u0451!"),c()()}if(t&2){let e=h();G(" \u0420\u0430\u0443\u043D\u0434 ",e.round," \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D! ")}}function bt(t,n){if(t&1&&(r(0,"li",25)(1,"div",26),d(2),c(),r(3,"span",27),d(4),c()()),t&2){let e=n.$implicit;u(2),_(e.title),u(2),_(e.level)}}function yt(t,n){if(t&1&&M(0,bt,5,2,"li",25,Ie),t&2){let e=h(2).$implicit;O(e.gamePlayer.successWords)}}function vt(t,n){}function wt(t,n){if(t&1&&(r(0,"ul",24),T(1,yt,2,0)(2,vt,0,0),c()),t&2){let e=h().$implicit;u(),S(e.gamePlayer.successWords.length?1:2)}}function Dt(t,n){if(t&1&&(r(0,"div",13)(1,"h2",16)(2,"button",17)(3,"div",18),H(4),r(5,"span",19)(6,"b"),d(7),c()(),r(8,"div"),Y(9,"span",20),r(10,"span",21),d(11),c()()()()(),r(12,"div",22)(13,"div",23),T(14,wt,3,1,"ng-template"),c()()()),t&2){let e=n.$implicit,i=n.$index,s=h(2),o=3-i;u(5),C("ngClass",K(5,xe,o==3,o==2,o==1,o<1)),u(2),_(e.gamePlayer.player.name),u(2),C("ngClass",K(10,xe,o==3,o==2,o==1,o<1))("innerHTML",s.stars(o),he),u(2),_(e.sum)}}function Tt(t,n){if(t&1){let e=w();r(0,"div",12),M(1,Dt,15,15,"div",13,ct),c(),r(3,"div",9)(4,"a",14),d(5,"\u041D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E"),c(),r(6,"button",15),f("click",function(){m(e);let s=h();return b(s.nextPlayer())}),d(7,"\u0418\u0433\u0440\u0430\u0442\u044C \u0435\u0449\u0451!"),c()()}if(t&2){let e=h();u(),O(e.gamePlayerResults),u(3),C("routerLink",e.routeCreator.main())}}var Re=class t{constructor(n){this.playersService=n;this.gameWordsProvider=new te(l(Ce))}round=1;state=0;currentPlayerNo=0;gameWordsProvider;gamePlayers=[];gamePlayerResults=[];ngOnInit(){this.initGamePlayers()}isLastPlayerInRound(){return this.gamePlayers.length==this.currentPlayerNo+1}playing(){this.state=2}nextPlayer(){this.currentPlayerNo=(this.currentPlayerNo+1)%this.gamePlayers.length,this.currentPlayerNo==0&&(this.resetCurrentWords(),this.round+=1),this.state=1}toResult(){this.gamePlayerResults=this.gamePlayers.map(n=>({gamePlayer:n,sum:n.successWords.reduce((e,i)=>(e+=i.level,e),0)})).sort((n,e)=>e.sum-n.sum),this.state=4}endRound(){this.state=3,console.log(this.gamePlayers)}get currentPlayer(){return this.currentGamePlayer.player}get currentGamePlayer(){return this.gamePlayers[this.currentPlayerNo]}toggleWord(n){let e=this.gamePlayers[this.currentPlayerNo].successWords.indexOf(n);e==-1?this.gamePlayers[this.currentPlayerNo].successWords.push(n):this.gamePlayers[this.currentPlayerNo].successWords.splice(e,1)}isWordSelected(n){return this.gamePlayers[this.currentPlayerNo].successWords.includes(n)}stars(n){return n>0?Array(n).fill("&#9733;").join(""):""}resetCurrentWords(){this.gamePlayers.forEach(n=>{n.currentWords=this.gameWordsProvider.nextWords(5)})}initGamePlayers(){this.gamePlayers=this.playersService.players.map(n=>({player:n,successWords:[],currentWords:this.gameWordsProvider.nextWords(5)})),this.state=1}routeCreator=Se;State=Ae;static \u0275fac=function(e){return new(e||t)(U(Te))};static \u0275cmp=A({type:t,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","gap-5"],decls:5,vars:1,consts:[[1,"text-center"],[1,"btn","btn-lg","btn-warning","d-inline-flex",3,"click"],[1,"d-flex","flex-column","gap-1","h-100"],[1,"d-flex","btn","btn-lg",3,"ngClass"],[1,"overflow-hidden","btn","btn-lg","btn-warning",3,"click"],[1,"d-flex","btn","btn-lg",3,"click","ngClass"],[1,"my-auto"],[1,"m-auto"],[1,"sm-auto"],[1,"d-flex"],[1,"btn","btn-lg","btn-outline-primary",3,"click"],[1,"btn","btn-lg","btn-success",3,"click"],["ngbAccordion",""],["ngbAccordionItem",""],[1,"btn","btn-lg","btn-outline-primary","w-100",3,"routerLink"],[1,"btn","btn-lg","btn-success","w-100",3,"click"],["ngbAccordionHeader",""],["ngbAccordionButton",""],[1,"d-flex","w-100"],[1,"ms-2","me-auto",3,"ngClass"],[1,"me-2",3,"ngClass","innerHTML"],[1,"badge","text-bg-danger","rounded-pill"],["ngbAccordionCollapse",""],["ngbAccordionBody",""],[1,"list-group"],[1,"list-group-item","d-flex","justify-content-between"],[1,"ms-2","me-auto"],[1,"badge","text-bg-primary","rounded-pill"]],template:function(e,i){e&1&&T(0,ut,1,0)(1,ht,6,1)(2,gt,9,3)(3,mt,6,1)(4,Tt,8,1),e&2&&S(i.state==i.State.LOADING?0:i.state==i.State.NEXT_PLAYER?1:i.state==i.State.PLAYING?2:i.state==i.State.END_ROUND?3:i.state==i.State.TO_RESULT?4:-1)},dependencies:[we,De,v,ke,Ee,Pe,X,L],styles:[".text-gold[_ngcontent-%COMP%]{color:#ffd63f}.text-silver[_ngcontent-%COMP%]{color:#e4e4e4}.text-blonze[_ngcontent-%COMP%]{color:#cda132}"]})},Ae=(o=>(o[o.LOADING=0]="LOADING",o[o.NEXT_PLAYER=1]="NEXT_PLAYER",o[o.PLAYING=2]="PLAYING",o[o.END_ROUND=3]="END_ROUND",o[o.TO_RESULT=4]="TO_RESULT",o))(Ae||{}),te=class{constructor(n){this.categoriesService=n}existingWords=[];isWordExisted(n){return this.existingWords.includes(n)}nextWords(n=5){let e=[];for(;n>e.length;){let i=this.categoriesService.getRandomWord();this.isWordExisted(i)||e.includes(i)||e.push(i)}return this.existingWords.push(...e),e.sort((i,s)=>i.level-s.level)}};export{Re as GameComponent};
